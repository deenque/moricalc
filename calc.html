<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>$MORI Hub - Расчет дохода</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="icon" href="https://moristake.in/images/favicon.ico" type="image/x-icon" />
  <style>
    @font-face {
      font-family: 'TT Firs Neue';
      src: url('https://moristake.in/fonts/TTFirsNeue-Regular.ttf') format('truetype');
      font-display: swap;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body, input, button, textarea, select, p, span, div, h1, h2, h3, h4, h5, h6 {
      font-family: 'TT Firs Neue', system-ui, -apple-system, sans-serif !important;
    }
    html,body{
      width:100%;height:100%;overflow:hidden;
      background:radial-gradient(circle at 50% 50%,#1b1a12 0%,#000 100%);
      color:#fff;
    }
    body{
      display:flex;flex-direction:column;
      position:fixed;inset:0;
      padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
      min-height:100dvh;
    }
    .app-container {
      width:100%; max-width:380px; height:100%; display:flex; flex-direction:column; margin:0 auto;
      position:relative;
    }
    .page {
      backdrop-filter:blur(20px) saturate(180%);
      background:rgba(255,255,255,.08);
      padding:44px 20px 100px 20px;
      flex:1; overflow-y:auto;
      display:none;
    }
    .page.active { display:block; }
    /* ПРЕМИУМ МЕНЮ */
    .premium-bottom-nav {
      position: fixed;
      bottom: 0; left: 50%; transform: translateX(-50%);
      width: 100%; max-width: 380px;
      padding: 14px 20px env(safe-area-inset-bottom) 20px;
      background: #0f0f11;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: 1000;
      display: flex;
      justify-content: space-around;
      gap: 12px;
      border-top: 1px solid #3a2f1a;
      box-shadow:
        0 -1px 0 #3a2f1a inset,
        0 -4px 12px rgba(255, 180, 0, 0.15),
        0 -8px 20px rgba(255, 160, 0, 0.08);
      background: linear-gradient(to bottom,
        rgba(30, 25, 15, 0.4) 0%,
        rgba(15, 15, 17, 0.95) 30%,
        #0f0f11 100%);
    }
    .premium-bottom-nav::before {
      content: "";
      position: absolute;
      top: 0; left: 12px; right: 12px; height: 1px;
      background: linear-gradient(90deg, transparent, #ffba00, #ff9500, #ffba00, transparent);
      opacity: 0.7;
    }
    .nav-item {
      flex: 1;
      padding: 11px 6px;
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.55);
      font-size: 11.5px;
      text-align: center;
      border-radius: 14px;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }
    .nav-item i { font-size: 21px; }
    .nav-item.active {
      color: #FFD500;
      background: rgb(163 163 163 / 14%);
      box-shadow: 0 4px 16px rgba(255, 213, 0, 0.25);
      border: 1px solid rgba(255,255,255,.18);
    }
    .nav-item:active { transform: scale(0.95); }
    h2{text-align:center;margin-bottom:4px;color:#FFD500;font-weight:600;font-size:20px;line-height:1.2;}
    .currency-toggle {
      display:flex;
      justify-content:center;
      gap:8px;
      margin:12px 0 18px 0;
    }
    .currency-toggle button {flex:1;display:flex;align-items:center;justify-content:center;gap:6px;
      background:rgba(255,255,255,.07);border-radius:12px;padding:8px 0;
      border:1px solid rgba(255,255,255,.1);color:#fff;font-size:13px;transition:all .3s;cursor:pointer;}
    .currency-toggle button.active {color:#FFD500;background:rgba(255,213,0,.15);border-color:#FFD500;}
    .currency-toggle button img {width:18px;height:12px;border-radius:2px;}
    .price-input-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 8px;
    }
    .token-price-input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: none;
      outline: none;
      font-size: 14px;
      text-align: center;
      background: rgba(255,255,255,.1);
      color: #fff;
      min-height: 48px;
    }
    .price-btn {
      width: 100%;
      background: rgba(255,255,255,.1);
      border: 1px solid rgba(255,255,255,.3);
      border-radius: 12px;
      padding: 12px 10px;
      color: #FFD500;
      font-size: 12px;
      cursor: pointer;
      transition: .3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .price-btn:hover,.price-btn:active {background:rgba(255,255,255,.2);}
    .input-group {margin-bottom:16px;}
    label {font-size:13px;color:rgba(255,255,255,.7);display:block;margin-bottom:6px;}
    .mode-toggle {display:flex;gap:8px;margin-top:8px;margin-bottom:12px;}
    .mode-toggle button {flex:1;background:rgba(255,255,255,.07);border-radius:12px;padding:8px 0;
      border:1px solid rgba(255,255,255,.1);color:#fff;font-size:13px;transition:all .3s;cursor:pointer;}
    .mode-toggle button.active {color:#FFD500;font-weight:400;background:rgba(255,213,0,.15);border-color:#FFD500;}
    .token-input,.buy-input {width:100%;padding:12px 14px;border-radius:12px;border:none;outline:none;
      font-size:14px;text-align:center;background:rgba(255,255,255,.1);color:#fff;min-height:48px;}
    .token-input::placeholder,.buy-input::placeholder {color:rgba(255,255,255,.4);}
    .comment {text-align:center;font-size:12px;color:#ffd500;margin-top:18px;}
    .btn {width:100%;background:linear-gradient(135deg,#FFD500,#BFA100);border:none;border-radius:12px;padding:14px;font-size:16px;
      color:#000;font-weight:600;cursor:pointer;transition:all .3s;min-height:52px;margin-top:8px;}
    .btn:hover,.btn:active {transform:translateY(-1px);box-shadow:0 0 20px rgba(255,213,0,.4);}
    .btn:disabled {opacity:0.6;cursor:not-allowed;transform:none;}
    .results {display:none;margin-top:16px;text-align:center;opacity:0;transition:opacity .5s ease;}
    .results p {margin:4px 0;font-size:15px;line-height:1.3;color:rgba(255,255,255,0.7);}
    .highlight {background:linear-gradient(90deg,#FFD500,#FFB800);-webkit-background-clip:text;-webkit-text-fill-color:transparent;
      font-weight:700;font-size:17px;}
    .course-info {font-size:11px;color:rgba(255,255,255,.6);text-align:center;margin-top:12px;}
    .course-error {color:#ff6b6b;}
    .xp-info {font-size:12px;color:#FFD500;text-align:center;margin-top:8px;font-weight:500;display:none;}
    .buy-currency-toggle {display:flex;justify-content:center;gap:8px;margin:12px 0 18px 0;}
    .buy-currency-toggle button {flex:1;display:flex;align-items:center;justify-content:center;gap:6px;
      background:rgba(255,255,255,.07);border-radius:12px;padding:8px 0;
      border:1px solid rgba(255,255,255,.1);color:#fff;font-size:13px;transition:all .3s;cursor:pointer;}
    .buy-currency-toggle button.active {color:#FFD500;background:rgba(255,213,0,.15);border-color:#FFD500;}
    .buy-currency-toggle button img {width:18px;height:12px;border-radius:2px;}
    .buy-results {margin-top:16px;text-align:center;}
    .buy-results p {margin:4px 0;font-size:15px;line-height:1.3;color:rgba(255,255,255,0.7);}
    .buy-action-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }
    .buy-action-row .btn {flex: 1;margin-top: 0;}
    .buy-now-btn {
      flex: 1;
      background: linear-gradient(135deg, #FFD500, #BFA100);
      color: #000;
      border: none;
      border-radius: 12px;
      padding: 14px 16px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 52px;
      display: flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
      text-decoration: none;
    }
    .buy-now-btn:hover, .buy-now-btn:active {
      transform: translateY(-1px);
      box-shadow: 0 0 20px rgba(255, 213, 0, 0.4);
    }
    .buy-now-btn i {margin-right: 6px;}
    .price-page-content {text-align: center;}
    .price-header {display: flex;align-items: center;justify-content: center;gap: 12px;margin-bottom: 16px;}
    .price-header img {width: 48px;height: 48px;border-radius: 50%;}
    .price-header h3 {font-size: 18px;color: #FFD500;margin: 0;}
    .current-price-big {font-size: 36px;font-weight: 700;margin: 8px 0;
      background: linear-gradient(90deg, #FFD500, #FFB800);
      -webkit-background-clip: text;-webkit-text-fill-color: transparent;}
    .price-change {font-size: 14px;font-weight: 600;margin: 4px 0;}
    .price-change.positive { color: #28a745; }
    .price-change.negative { color: #dc3545; }
    .price-update {font-size: 12px;color: rgba(255,255,255,0.6);margin-bottom: 16px;}
    .price-stats-grid {display: grid;grid-template-columns: 1fr 1fr;gap: 12px;margin: 20px 0 12px 0;}
    .price-stat-item {background: rgba(255,255,255,0.05);border-radius: 12px;padding: 12px;text-align: center;}
    .price-stat-label {font-size: 12px;color: rgba(255,255,255,0.6);}
    .price-stat-value {font-size: 16px;font-weight: 600;color: #FFD500;margin-top: 4px;line-height: 1.3;}
    .price-stat-value small {font-size: 12px;opacity: 0.9;display: block;color: #fff;margin-top: 2px;}
    .chart-container {position: relative;height: 220px;margin: 8px 0 12px 0;background: rgba(255,255,255,0.05);border-radius: 12px;overflow: hidden;}
    .chart-loading {position: absolute;top: 50%; left: 50%;transform: translate(-50%, -50%);color: rgba(255,255,255,0.6);font-size: 14px;}
    .price-links {display: flex;justify-content: center;gap: 16px;margin: 20px 0;}
    .price-link {color: #FFD500;text-decoration: none;font-size: 14px;display: flex;align-items: center;gap: 6px;}
    .price-link i {font-size: 18px;}
    .info-page-content {text-align: center;}
    .info-block {background: rgba(255,255,255,0.05);border-radius: 12px;padding: 16px;margin: 16px 0;text-align: left;}
    .info-block h3 {color: #FFD500;font-size: 16px;margin-bottom: 8px;text-align: center;}
    .info-block p {font-size: 13px;line-height: 1.4;color: rgba(255,255,255,0.8);}
    .info-link {color: #FFD500;text-decoration: none;}

    /* Stake стили */
    .stake-section {display:none;margin-top:30px;}
    .stake-title {font-size:20px;color:#FFD500;text-align:center;margin:20px 0 6px;font-weight:600;}
    .stake-subtitle {text-align:center;font-size:13px;color:rgba(255,255,255,0.55);margin-bottom:20px;line-height:1;}
    .stake-buttons {display:flex;flex-direction:column;gap:12px;max-width:320px;margin:0 auto;}
    .stake-btn {
      background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 20px;color:#fff;font-size:15px;cursor:pointer;transition:all .3s;
      display:flex;justify-content:space-between;align-items:center;
    }
    .stake-btn.active {background:rgba(255,213,0,.15);border-color:#FFD500;color:#FFD500;}
    .stake-result {display:none;margin-top:25px;padding-bottom:120px;}
    .stake-result-wrapper {
      background:rgba(255,255,255,0.05);border:1px solid rgba(255,213,0,0.2);border-radius:16px;padding:18px 16px;text-align:center;
    }
    .stake-label {font-size:13px;color:rgba(255,255,255,0.7);margin-bottom:4px;}
    .stake-initial-big {font-size:30px;font-weight:700;color:#fff;line-height:1.1;}
    .stake-profit-big {font-size:30px;font-weight:700;background:linear-gradient(90deg,#FFD500,#FFB800);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:6px 0;}
    .stake-total-wrapper {margin-top:18px;padding-top:14px;border-top:1px dashed rgba(255,213,0,0.3);}
    .stake-label-total {font-size:13px;color:rgba(255,255,255,0.6);}
    #stakePeriodSelected {color:#FFD500;font-weight:600;}
    .stake-total-big {font-size:36px;font-weight:700;color:#FFD500;line-height:2;}
    .stake-unlock-date {margin-top:24px;padding-top:20px;border-top:1px dashed rgba(255,213,0,0.3);text-align:center;}
    .unlock-label {font-size:13px;color:rgba(255,255,255,0.6);margin-bottom:6px;}
    .unlock-date-big {font-size:24px;font-weight:700;color:#FFD500;}
    .staking-btn {
   display: block;        /* превращает в блочный — можно центрировать */
  width: 80%;            /* ширина кнопки (можешь менять: 70–100%) */
  margin: 25px auto 0;   /* auto — центрирует по горизонтали */
  text-align: center;    /* текст по центру */
  padding: 14px 0;       /* высота кнопки */
}
}
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Калькулятор -->
    <div class="page calculator-page active" id="calculatorPage">
      <h2>Прогноз дохода $MORI</h2>
      <br>
      <div class="input-group">
        <label id="inputLabel">Количество ваших токенов:</label>
        <div class="mode-toggle">
          <button id="btnMORI" class="active">$MORI</button>
          <button id="btnXP">XP</button>
          <button id="btnStake">Stake</button>
        </div>
        <input type="text" id="tokenInput" class="token-input" placeholder="Например: 1000" inputmode="decimal" enterkeyhint="done" autocomplete="off">
      </div>
 
      <div class="input-group" id="priceGroup">
        <label>Желаемая цена $MORI:</label>
        <div class="currency-toggle" id="currencyToggle">
          <button id="btnUSD" class="active">
            <img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" alt="USD"> USD
          </button>
          <button id="btnRUB">
            <img src="https://upload.wikimedia.org/wikipedia/en/f/f3/Flag_of_Russia.svg" alt="RUB"> RUB
          </button>
        </div>
        <div class="price-input-row">
          <input type="text" step="0.001" id="tokenPrice" class="token-price-input" placeholder="0,00" inputmode="decimal" enterkeyhint="done" autocomplete="off">
          <div class="price-btn" id="priceBtn">Текущая цена</div>
        </div>
        <div class="comment">Цена 1 MORI в выбранной валюте</div>
        <p style="font-size:12px;color:rgba(255,255,255,0.6);margin:4px 0 0;text-align:center;line-height:1.2;">
          (выберите валюту, нажав на кнопку RUB или USD)
        </p>
      </div>
      <p class="xp-info" id="xpInfo">Курс: 1 $MORI = 50 XP</p>
      <button class="btn" id="calcBtn">Рассчитать</button>
      <div class="course-info" id="courseInfo">
        Курс USD/RUB: <span id="courseStatus">Загрузка...</span>
      </div>
      <div class="results" id="resultsBlock">
        <div id="resultPrimary"></div>
        <div id="resultSecondary"></div>
        <div id="resultTertiary"></div>
      </div>

      <!-- Stake -->
      <div class="stake-section" id="stakeSection">
        <div class="stake-title">Стейкинг доход</div>
        <div class="input-group">
          <label>Сумма MORI</label>
          <input type="text" id="stakeAmount" class="token-input" placeholder="Например: 1000" inputmode="decimal" enterkeyhint="done" autocomplete="off">
        </div>
        <div class="stake-title">Срок стейкинга</div>
        <div class="stake-subtitle">(максимум 12 месяцев)</div>
        <div class="stake-buttons">
          <button class="stake-btn active" data-months="1" data-apr="15">1 месяц<span>15% APR (XP: 22.5%)</span></button>
          <button class="stake-btn" data-months="3" data-apr="30">3 месяца<span>30% APR (XP: 45%)</span></button>
          <button class="stake-btn" data-months="6" data-apr="60">6 месяцев<span>60% APR (XP: 90%)</span></button>
          <button class="stake-btn" data-months="12" data-apr="100">12 месяцев<span>100% APR (XP: 150%)</span></button>
        </div>
        <div class="stake-result" id="stakeResult">
          <div class="stake-result-wrapper">
            <div class="stake-label">Вы стейкаете</div>
            <div class="stake-initial-big" id="stakeInitial">1 000 MORI</div>
            <div class="stake-label">Ваш доход за выбранный период</div>
            <div class="stake-profit-big" id="stakeProfit">+1 000 MORI</div>
            <div class="stake-total-wrapper">
              <div class="stake-label-total">Итого на балансе через</div>
              <div id="stakePeriodSelected">12 месяцев</div>
              <div class="stake-total-big" id="stakeTotal">2 000 MORI</div>
            </div>
            <div class="stake-unlock-date">
              <div class="unlock-label">Дата разблокировки:</div>
              <div class="unlock-date-big" id="unlockDate">18 декабря 2025</div>
            </div>
          </div>
          <a href="https://moristake.in" class="buy-now-btn staking-btn"" target="_blank">Застейкать</a>
        </div>
      </div>
    </div>

    <!-- Главная (покупка) -->
    <div class="page buy-page" id="buyPage">
      <h2>Купить $MORI</h2>
      <br>
      <div class="input-group">
        <label for="buyInput">Хочу купить на:</label>
        <input type="text" id="buyInput" class="buy-input" placeholder="Например: 1000" inputmode="decimal" enterkeyhint="done" autocomplete="off">
      </div>
      <div class="buy-currency-toggle" id="buyCurrencyToggle">
        <button id="buyBtnRUB" class="active">
          <img src="https://upload.wikimedia.org/wikipedia/en/f/f3/Flag_of_Russia.svg" alt="RUB"> RUB
        </button>
        <button id="buyBtnUSD">
          <img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" alt="USD"> USD
        </button>
      </div>
      <div class="buy-action-row">
        <button class="btn" id="buyCalcBtn">Рассчитать</button>
        <a href="https://t.me/MoriForum/1321532/1321535" class="buy-now-btn" target="_blank"> Купить</a>
      </div>
      
      <div class="course-info" id="buyCourseInfo">
        Курс USD/RUB: <span id="buyCourseStatus">Загрузка...</span>
      </div>
      
      <div class="buy-results" id="buyResultsBlock" style="display:none;">
        <div id="buyResultMori"></div>
        <div id="buyResultFiat"></div>
      </div>
    </div>

  <!-- Цена -->
<div class="page price-page" id="pricePage">
  <h2>Текущая цена $MORI</h2>
  <br>
  <div class="price-page-content">
    <div class="price-header">
      <img id="coinLogo" src="" alt="$MORI" style="display:none;">
      <h3>$MORI / USD</h3>
    </div>
    <div class="current-price-big" id="currentPriceBig">Загрузка...</div>
    <div class="price-change" id="priceChange24h">-</div>
    <div class="price-update" id="priceUpdateTime"></div>


    <div class="price-stats-grid">
      <div class="price-stat-item"><div class="price-stat-label">Рыночная капитализация</div><div class="price-stat-value" id="marketCap">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">Объём торгов на биржах (24ч)</div><div class="price-stat-value" id="volume24h">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">Циркулирующий объём</div><div class="price-stat-value" id="circulatingSupply">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">Максимальный объём</div><div class="price-stat-value" id="totalSupply">-</div></div>

      <!-- Стейкинг -->
      <div class="price-stat-item">
        <div class="price-stat-label">Всего застейкано</div>
        <div class="price-stat-value" id="totalStaked">Загрузка...</div>
      </div>
      <div class="price-stat-item">
        <div class="price-stat-label">Заблокировано (USD)</div>
        <div class="price-stat-value" id="tvlUsd">Загрузка...</div>
      </div>

      <!-- ATH и т.д. -->
      <div class="price-stat-item"><div class="price-stat-label">ATH (макс.все время)</div><div class="price-stat-value" id="ath">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">ATL (мин.все время)</div><div class="price-stat-value" id="atl">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">Максимум за 24ч</div><div class="price-stat-value" id="high24h" style="color:#28a745;">-</div></div>
      <div class="price-stat-item"><div class="price-stat-label">Минимум за 24ч</div><div class="price-stat-value" id="low24h" style="color:#dc3545;">-</div></div>
    </div>

    <div class="chart-container" id="chartContainer">
      <div class="chart-loading" id="chartLoading">Загрузка графика...</div>
    </div>
    <div class="price-links">
      <a href="https://www.coingecko.com/en/coins/mori-coin" class="price-link" target="_blank">CoinGecko</a>
      <a id="websiteLink" href="#" class="price-link" target="_blank" style="display:none;">Сайт</a>
      <a id="twitterLink" href="#" class="price-link" target="_blank" style="display:none;">Twitter</a>
    </div>
    <p style="font-size:12px;color:rgba(255,255,255,0.6);margin-top:20px;">
      График: свечи за 30 дней (TradingView). Данные обновляются автоматически.
    </p>
  </div>
</div>


    <!-- Инфо -->
    <div class="page info-page" id="infoPage">
      <h2>Информация о $MORI</h2>
      <br>
      <div class="info-page-content">
        <div class="info-block"><h3>Что такое $MORI?</h3><p> $MORI — это мем-токен, но не очередной мусор. Это валюта нового порядка. Вирус в системе. Каждый холдер — соучастник. Каждая транзакция — шаг к легенде.</p></div>
       <div class="info-block"><h3>Как купить?</h3><p>Перейдите в раздел <strong>Главная</strong>, выбрав желаемую валюту и расчитайте сумму, далее нажмите <strong>Купить</strong>, затем следуйте инструкции.</p></div>
        <div class="info-block"><h3>Валюта XP</h3><p>1 $MORI = 50 XP (фиксированный курс) • XP = реальные деньги • Можно обменять на $MORI и вывести или оставить для игры в MORI WIN • Топ-100 по XP каждый сезон получает крупные выплаты • Любая активность = профит.</p></div>
        <div class="info-block">
  <h3>Стейкинг $MORI</h3>
  <p>Замораживайте $MORI — получайте до <strong style="color:#FFD500;">100% годовых</strong> в MORI или до <strong style="color:#FFD500;">150% в XP</strong>.<br>Сроки: 1 / 3 / 6 / 12 месяцев. Ранний вывод — штраф 50%. Чем дольше держите — тем больше зарабатываете. Застейкать → <a href="https://moristake.in" target="_blank" style="color:#FFD500;">moristake.in</a>
  </p>
</div>

      <div class="info-block">
  <h3></i> Поддержка и ссылки</h3>

  <div style="text-align:center; font-size:15px;">

    <!-- Официальный сайт -->
    <div style="margin:26px 0;">
      <strong style="color:#FFD500;"><i class="fas fa-globe"></i> Официальный сайт</strong><br>
      <span style="opacity:0.8; font-size:14px;">Вся информация о проекте, экосистеме, утилити, дорожной карте и актуальных обновлениях — в одном месте. Здесь собраны ключевые материалы, ссылки, документы и всё, что нужно знать именно тебе!</span><br><br>
      <a href="https://morico.in" target="_blank" style="color:#fff; text-decoration:none; font-size:16.5px;">
        <i class="fas fa-external-link-alt"></i> morico.in
      </a>
    </div>

    <!-- Казино -->
    <div style="margin:26px 0;">
      <strong style="color:#FFD500;"><i class="fas fa-dice"></i> Казино MORI WIN (18+)</strong><br>
      <span style="opacity:0.8; font-size:14px;">Играешь на $MORI → все проигранные токены и комиссия сжигаются навсегда.<br> Меньше токенов в обороте — выше цена для всех холдеров.</span><br><br>
      <a href="https://mori.win" target="_blank" style="color:#fff; text-decoration:none;">
        <i class="fas fa-gamepad"></i> mori.win
      </a> · 
      <a href="https://t.me/MoriWinOfficial" target="_blank" style="color:#FFD500; text-decoration:none;">
        <i class="fab fa-telegram-plane"></i> @MoriWinOfficial
      </a>
    </div>

    <!-- VPN -->
    <div style="margin:26px 0;">
      <strong style="color:#FFD500;"><i class="fas fa-shield-alt"></i> Собственный VPN</strong><br>
      <span style="opacity:0.8; font-size:14px;">MORI VPN — быстрый и стабильный VPN, работающий в России. Бесплатен для стейкеров, а оплата в $MORI вдвое выгоднее. Уникальная связка TOR поверх VPN даёт максимальную анонимность. Полный no-logs — никаких данных и истории. Поддержка всех устройств, удобная оплата и реферальная система делают MORI VPN максимально доступным.</span><br><br>
      <a href="https://morivpn.com" target="_blank" style="color:#fff; text-decoration:none;">
        <i class="fas fa-lock"></i> morivpn.com
      </a> · 
      <a href="https://t.me/MoriVpnOfficial" target="_blank" style="color:#FFD500; text-decoration:none;">
        <i class="fab fa-telegram-plane"></i> @MoriVpnOfficial
      </a>
    </div>

    <!-- Сообщество -->
    <div style="margin:32px 0 16px;">
      <strong style="color:#FFD500; font-size:17px;"><i class="fas fa-users"></i> Сообщество</strong><br>
      <span style="opacity:0.8; font-size:14px;">Сильнейшее комьюнити — более 80 000 участников.
Обмен опытом, обсуждение идей и новостей проекта, поддержка и бонусы для участников — всё в одном месте. MORI — это не просто токен, это активное сообщество людей, объединённых одной идеей.</span>
    </div>

    <div style="line-height:2.3;">
      <div><a href="https://t.me/MORIAPPBOT?start=TES36T" target="_blank" style="color:#FFD500; text-decoration:none;"><i class="fas fa-robot"></i> @moriappbot — бот</a></div>
      <div><a href="https://t.me/moricoin_official" target="_blank" style="color:#FFD500; text-decoration:none;"><i class="fas fa-bullhorn"></i> @moricoin_official — новости</a></div>
      <div><a href="https://t.me/moriforum" target="_blank" style="color:#FFD500; text-decoration:none;"><i class="fas fa-comments"></i> @moriforum — главный чат</a></div>
      <div><a href="https://t.me/moriwork" target="_blank" style="color:#FFD500; text-decoration:none;"><i class="fas fa-briefcase"></i> @moriwork — рабочий чат</a></div>
      <div><a href="https://t.me/moriclipforum" target="_blank" style="color:#FFD500; text-decoration:none;"><i class="fas fa-video"></i> @moriclipforum — нарезки</a></div>
    </div>

    <!-- YouTube -->
    <div style="margin:32px 0 10px;">
      <strong style="color:#FFD500;"><i class="fab fa-youtube"></i> YouTube</strong><br>
      <span style="opacity:0.8; font-size:14px;">Именно здесь ты увидишь MORI GAMES — битвы пользователей за денежные вознаграждения, славу и безумие!</span><br><br>
      <a href="https://www.youtube.com/@mori_coin" target="_blank" style="color:#FFD500; text-decoration:none; font-size:15px;">
        youtube.com/@mori_coin
      </a>
    </div>

  </div>
</div>


      </div>
    </div>

    <!-- Нижнее меню -->
    <div class="premium-bottom-nav">
       <button class="nav-item" data-page="buyPage"><i class="fas fa-home"></i><span>Главная</span></button>
      <button class="nav-item active" data-page="calculatorPage"><i class="fas fa-calculator"></i><span>Калькулятор</span></button>
      <button class="nav-item" data-page="pricePage"><i class="fas fa-dollar-sign"></i><span>Цена</span></button>
      <button class="nav-item" data-page="infoPage"><i class="fas fa-info-circle"></i><span>Инфо</span></button>
    </div>
  </div>


<script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
    const TOKEN_MINT = '8ZHE4ow1a2jjxuoMfyExuNamQNALv5ekZhsBn5nMDf5e';
    let coinData = {};
    let usdToRub = null;
    let userHasEditedPrice = false;
    let lastPriceUpdate = null;
    let tvWidget = null;

    const navItems = document.querySelectorAll('.nav-item[data-page]');
    const pages = document.querySelectorAll('.page');

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const target = item.dataset.page;
        navItems.forEach(nav => nav.classList.remove('active'));
        item.classList.add('active');
        pages.forEach(page => page.classList.remove('active'));
        document.getElementById(target).classList.add('active');
        if (target === 'pricePage') {
          initTradingViewChart();
          updatePricePage(coinData.market_data || {}, coinData.image?.large, coinData.links);
        }
      });
    });

    function initTradingViewChart() {
      const container = document.getElementById('chartContainer');
      const loadingEl = document.getElementById('chartLoading');
      if (loadingEl) loadingEl.style.display = 'block';
      if (tvWidget) return;

      const script = document.createElement('script');
      script.src = 'https://s3.tradingview.com/tv.js';
      script.onload = () => {
        tvWidget = new TradingView.widget({
          "width": "100%",
          "height": 220,
          "symbol": "MORIUSDT",
          "interval": "D",
          "timezone": "Etc/UTC",
          "theme": "dark",
          "style": "1",
          "locale": "ru",
          "toolbar_bg": "#f1f3f6",
          "enable_publishing": false,
          "hide_top_toolbar": false,
          "hide_legend": true,
          "save_image": false,
          "container_id": "chartContainer"
        });
        if (loadingEl) loadingEl.style.display = 'none';
      };
      document.head.appendChild(script);
    }

    async function loadCourse(retry = 0) {
      const max = 3;
      const statusElements = [document.getElementById('courseStatus'), document.getElementById('buyCourseStatus')];
      statusElements.forEach(el => el.textContent = retry ? `Попытка ${retry+1}/${max}...` : 'Загрузка...');
      try {
        const ctrl = new AbortController();
        const t = setTimeout(() => ctrl.abort(), 8000);
        const r = await fetch('https://api.exchangerate-api.com/v4/latest/USD', { signal: ctrl.signal });
        clearTimeout(t);
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        const d = await r.json();
        if (d.rates?.RUB) {
          usdToRub = parseFloat(d.rates.RUB);
          const now = new Date();
          const dateStr = `${now.toLocaleDateString('ru-RU')}, ${now.toTimeString().slice(0,5)}`;
          statusElements.forEach(el => el.innerHTML = `${usdToRub.toFixed(2)} <small>(на ${dateStr})</small>`);
          updateAllPrices();
        } else throw new Error('Нет RUB');
      } catch (e) {
        console.error(e);
        if (retry < max-1) { setTimeout(() => loadCourse(retry+1), 1500); return; }
        usdToRub = null;
        statusElements.forEach(el => { el.textContent = 'Ошибка API'; el.className = 'course-error'; });
      }
    }
    loadCourse(); setInterval(loadCourse, 300000);

    async function fetchCoinData() {
      try {
        const ctrl = new AbortController();
        const t = setTimeout(() => ctrl.abort(), 8000);
        const r = await fetch('https://api.coingecko.com/api/v3/coins/mori-coin?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false&sparkline=false', { signal: ctrl.signal });
        clearTimeout(t);
        const d = await r.json();
        if (d && d.id) {
          coinData = d;
          lastPriceUpdate = new Date();
          updateAllPrices();
        }
      } catch (e) { console.log('CoinGecko full data:', e); }
    }
    fetchCoinData(); setInterval(fetchCoinData, 60000);

    function updateAllPrices() {
      if (Object.keys(coinData).length === 0) return;
      const market = coinData.market_data || {};
      const priceUSD = market.current_price?.usd || 0;
      const priceRUB = market.current_price?.rub || (priceUSD * (usdToRub || 0));
      updateCalcPriceBtn(priceUSD, priceRUB);
      updatePricePage(market, coinData.image?.large, coinData.links);
    }

    function updateCalcPriceBtn(priceUSD, priceRUB) {
      if (typeof mode === 'undefined' || mode !== 'MORI' || !usdToRub) return;
      const display = currentCurrency === 'USD' ? priceUSD : priceRUB;
      const dec = currentCurrency === 'USD' ? 6 : 2;
      const priceBtnEl = document.getElementById('priceBtn');
      if (priceBtnEl) {
        priceBtnEl.textContent = `Текущая: ${display ? display.toFixed(dec) : '-'} ${currentCurrency === 'USD' ? '$' : '₽'}`;
        if (!userHasEditedPrice && display) {
          const tokenPriceInput = document.getElementById('tokenPrice');
          if (tokenPriceInput) tokenPriceInput.value = display.toFixed(dec);
        }
        priceBtnEl.onclick = () => {
          if (display) {
            document.getElementById('tokenPrice').value = display.toFixed(dec);
            userHasEditedPrice = true;
          }
        };
      }
    }

    function updatePricePage(market, logoUrl, links) {
      if (logoUrl) {
        document.getElementById('coinLogo').src = logoUrl;
        document.getElementById('coinLogo').style.display = 'block';
      }

      const priceUSD = market.current_price?.usd || 0;
      document.getElementById('currentPriceBig').textContent = `$${priceUSD.toFixed(6)}`;

      const change24h = market.price_change_percentage_24h || 0;
      const changeEl = document.getElementById('priceChange24h');
      changeEl.textContent = `${change24h > 0 ? '+' : ''}${change24h.toFixed(2)}% (24ч)`;
      changeEl.className = 'price-change ' + (change24h > 0 ? 'positive' : change24h < 0 ? 'negative' : '');

      if (lastPriceUpdate) {
        document.getElementById('priceUpdateTime').textContent = `Обновлено: ${lastPriceUpdate.toLocaleTimeString('ru-RU')}`;
      }

      const formatNumber = (num, decimals = 0) => num ? num.toLocaleString('ru-RU', { maximumFractionDigits: decimals }) : '-';
      const formatUSD = (num) => num ? `$${formatNumber(num, 0)}` : '-';

      document.getElementById('marketCap').textContent = formatUSD(market.market_cap?.usd);
      document.getElementById('volume24h').textContent = formatUSD(market.total_volume?.usd);
      document.getElementById('circulatingSupply').textContent = formatNumber(market.circulating_supply, 0) + ' $MORI';
      document.getElementById('totalSupply').textContent = formatNumber(market.total_supply, 0) + ' $MORI';

      // ATH & ATL
      const athUSD = market.ath?.usd || 0;
      const atlUSD = market.atl?.usd || 0;
      const high24hUSD = market.high_24h?.usd || 0;
      const low24hUSD = market.low_24h?.usd || 0;

      const athRub = usdToRub ? (athUSD * usdToRub).toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ₽' : '- ₽';
      const atlRub = usdToRub ? (atlUSD * usdToRub).toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ₽' : '- ₽';
      const high24hRub = usdToRub ? (high24hUSD * usdToRub).toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ₽' : '- ₽';
      const low24hRub = usdToRub ? (low24hUSD * usdToRub).toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ₽' : '- ₽';

      document.getElementById('ath').innerHTML = `$${athUSD.toFixed(6)}<small>${athRub}</small>`;
      document.getElementById('atl').innerHTML = `$${atlUSD.toFixed(6)}<small>${atlRub}</small>`;
      document.getElementById('high24h').innerHTML = `$${high24hUSD.toFixed(6)}<small>${high24hRub}</small>`;
      document.getElementById('low24h').innerHTML = `$${low24hUSD.toFixed(6)}<small>${low24hRub}</small>`;

      // Ссылки
      const websiteEl = document.getElementById('websiteLink');
      if (links?.homepage?.[0]) {
        websiteEl.href = links.homepage[0];
        websiteEl.style.display = 'flex';
      } else websiteEl.style.display = 'none';

      const twitterEl = document.getElementById('twitterLink');
      if (links?.twitter_screen_name) {
        twitterEl.href = `https://twitter.com/${links.twitter_screen_name}`;
        twitterEl.style.display = 'flex';
      } else twitterEl.style.display = 'none';
    }

    // === Остальной код калькулятора (без изменений) ===
    const btnMORI = document.getElementById('btnMORI');
    const btnXP = document.getElementById('btnXP');
    const btnStake = document.getElementById('btnStake');
    const tokenInput = document.getElementById('tokenInput');
    const tokenPriceInput = document.getElementById('tokenPrice');
    const calcBtn = document.getElementById('calcBtn');
    const resultsBlock = document.getElementById('resultsBlock');
    const resultPrimary = document.getElementById('resultPrimary');
    const resultSecondary = document.getElementById('resultSecondary');
    const resultTertiary = document.getElementById('resultTertiary');
    const xpInfo = document.getElementById('xpInfo');
    const priceGroup = document.getElementById('priceGroup');
    const currencyToggle = document.getElementById('currencyToggle');
    const inputLabel = document.getElementById('inputLabel');
    const stakeSection = document.getElementById('stakeSection');
    let mode = 'MORI';
    let currentCurrency = 'USD';
    const XP_PER_MORI = 50;

    btnMORI.onclick = () => { if (mode === 'MORI') return; mode = 'MORI'; setModeActive('btnMORI'); showMoriMode(); };
    btnXP.onclick = () => { if (mode === 'XP') return; mode = 'XP'; setModeActive('btnXP'); showXPMode(); };
    btnStake.onclick = () => { if (mode === 'Stake') return; mode = 'Stake'; setModeActive('btnStake'); showStakeMode(); calcStake(); };

    function setModeActive(activeId) {
      [btnMORI, btnXP, btnStake].forEach(b => b.classList.remove('active'));
      document.getElementById(activeId).classList.add('active');
      resultsBlock.style.display = 'none';
    }

    function showMoriMode() {
      currencyToggle.style.display = 'flex';
      priceGroup.style.display = 'block';
      xpInfo.style.display = 'none';
      stakeSection.style.display = 'none';
      inputLabel.textContent = 'Количество ваших токенов:';
      tokenInput.placeholder = 'Например: 1000';
      tokenInput.style.display = 'block';
      calcBtn.style.display = 'block';
    }

    function showXPMode() {
      currencyToggle.style.display = 'none';
      priceGroup.style.display = 'none';
      xpInfo.style.display = 'block';
      stakeSection.style.display = 'none';
      inputLabel.textContent = 'Количество вашей валюты:';
      tokenInput.placeholder = 'Например: 5000';
      tokenInput.value = '';
      tokenInput.style.display = 'block';
      calcBtn.style.display = 'block';
    }

    function showStakeMode() {
      currencyToggle.style.display = 'none';
      priceGroup.style.display = 'none';
      xpInfo.style.display = 'none';
      stakeSection.style.display = 'block';
      tokenInput.style.display = 'none';
      calcBtn.style.display = 'none';
      resultsBlock.style.display = 'none';
    }

    // Stake
    const stakeAmount = document.getElementById('stakeAmount');
    const stakeResult = document.getElementById('stakeResult');
    const stakeInitial = document.getElementById('stakeInitial');
    const stakeProfit = document.getElementById('stakeProfit');
    const stakeTotal = document.getElementById('stakeTotal');

    document.querySelectorAll('.stake-btn').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('.stake-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        calcStake();
      };
    });
    stakeAmount.addEventListener('input', calcStake);

    function calcStake() {
      const active = document.querySelector('.stake-btn.active');
      if (!active || stakeAmount.value.trim() === '') {
        stakeResult.style.display = 'none';
        return;
      }
      const amount = parseFloat(stakeAmount.value.replace(/,/g, '.')) || 0;
      if (amount <= 0) { stakeResult.style.display = 'none'; return; }

      const months = parseInt(active.dataset.months);
      const apr = parseInt(active.dataset.apr);
      let shortPeriod = months === 1 ? '1 месяц' : (months >= 5 || months === 12) ? months + ' месяцев' : months + ' месяца';

      const profit = amount * (apr / 100) * (months / 12);
      const total = amount + profit;
      const now = new Date();
      const unlockDate = new Date(now.getFullYear(), now.getMonth() + months, now.getDate());
      const formattedDate = unlockDate.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' }).replace(' г.', '');

      stakeInitial.textContent = Number(amount).toLocaleString('ru-RU') + ' MORI';
      stakeProfit.textContent = '+' + Math.round(profit).toLocaleString('ru-RU') + ' MORI';
      stakeTotal.textContent = Math.round(total).toLocaleString('ru-RU') + ' MORI';
      document.getElementById('stakePeriodSelected').textContent = shortPeriod;
      document.getElementById('unlockDate').textContent = formattedDate;
      stakeResult.style.display = 'block';
    }

    // Кнопки валют в калькуляторе
    const btnUSD = document.getElementById('btnUSD');
    const btnRUB = document.getElementById('btnRUB');
    btnUSD.onclick = () => { if (currentCurrency === 'USD') return; currentCurrency = 'USD'; btnUSD.classList.add('active'); btnRUB.classList.remove('active'); updateCalcPriceBtn(coinData.market_data?.current_price?.usd, coinData.market_data?.current_price?.rub); };
    btnRUB.onclick = () => { if (currentCurrency === 'RUB') return; currentCurrency = 'RUB'; btnRUB.classList.add('active'); btnUSD.classList.remove('active'); updateCalcPriceBtn(coinData.market_data?.current_price?.usd, coinData.market_data?.current_price?.rub); };

    calcBtn.onclick = () => {
      if (!usdToRub || Object.keys(coinData).length === 0) { alert('Данные не загружены. Подождите или обновите страницу.'); return; }
      const market = coinData.market_data || {};
      const priceUSD = market.current_price?.usd || 0;
      const raw = tokenInput.value.replace(',', '.').trim();
      const amount = parseFloat(raw) || 0;
      if (amount <= 0) { alert('Введите количество ваших токенов'); return; }

      let totalUSD, totalRUB, moriFromXP = 0;
      if (mode === 'MORI') {
        const priceInput = parseFloat(tokenPriceInput.value.replace(',', '.')) || priceUSD;
        const priceInUSD = currentCurrency === 'USD' ? priceInput : (priceInput / usdToRub);
        totalUSD = amount * priceInUSD;
      } else {
        moriFromXP = amount / XP_PER_MORI;
        totalUSD = moriFromXP * priceUSD;
      }
      totalRUB = totalUSD * usdToRub;

      const usdStr = totalUSD.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + ' $';
      const rubStr = totalRUB.toLocaleString('ru-RU', { maximumFractionDigits: 0 }) + ' ₽';

      resultsBlock.style.display = 'block'; resultsBlock.style.opacity = 0;
      setTimeout(() => resultsBlock.style.opacity = 1, 50);

      if (mode === 'MORI') {
        resultPrimary.innerHTML = `<p>Стоимость в USD: <strong class="highlight">${usdStr}</strong></p>`;
        resultSecondary.innerHTML = `<p>Стоимость в RUB: <strong class="highlight">${rubStr}</strong></p>`;
        resultTertiary.innerHTML = '';
      } else {
        const moriStr = moriFromXP.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + ' $MORI';
        resultPrimary.innerHTML = `<p>Эквивалент $MORI: <strong class="highlight">${moriStr}</strong></p>`;
        resultSecondary.innerHTML = `<p>Стоимость в USD: <strong class="highlight">${usdStr}</strong></p>`;
        resultTertiary.innerHTML = `<p>Стоимость в RUB: <strong class="highlight">${rubStr}</strong></p>`;
      }
    };

    // Покупка
    const buyBtnRUB = document.getElementById('buyBtnRUB');
    const buyBtnUSD = document.getElementById('buyBtnUSD');
    const buyInput = document.getElementById('buyInput');
    const buyCalcBtn = document.getElementById('buyCalcBtn');
    const buyResultsBlock = document.getElementById('buyResultsBlock');
    const buyResultMori = document.getElementById('buyResultMori');
    const buyResultFiat = document.getElementById('buyResultFiat');
    let buyCurrency = 'RUB';

    buyBtnRUB.onclick = () => { if (buyCurrency === 'RUB') return; buyCurrency = 'RUB'; buyBtnRUB.classList.add('active'); buyBtnUSD.classList.remove('active'); };
    buyBtnUSD.onclick = () => { if (buyCurrency === 'USD') return; buyCurrency = 'USD'; buyBtnUSD.classList.add('active'); buyBtnRUB.classList.remove('active'); };

    buyCalcBtn.onclick = () => {
      if (!usdToRub || Object.keys(coinData).length === 0) { alert('Данные не загружены. Подождите или обновите страницу.'); return; }
      const market = coinData.market_data || {};
      const priceUSD = market.current_price?.usd || 0;
      const raw = buyInput.value.replace(',', '.').trim();
      const amountFiat = parseFloat(raw) || 0;
      if (amountFiat <= 0) { alert('Введите корректное значение'); return; }

      let amountInUSD = buyCurrency === 'USD' ? amountFiat : (amountFiat / usdToRub);
      let moriAmount = amountInUSD / priceUSD;

      const moriStr = moriAmount.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + ' $MORI';
      const fiatStr = amountFiat.toLocaleString('ru-RU', { maximumFractionDigits: 2 }) + (buyCurrency === 'USD' ? ' $' : ' ₽');

      buyResultsBlock.style.display = 'block';
      buyResultMori.innerHTML = `<p>Вы получите: <strong class="highlight">${moriStr}</strong></p>`;
      buyResultFiat.innerHTML = `<p>На сумму: <strong class="highlight">${fiatStr}</strong></p>`;
    };
    
    

// Живые данные с Mori API + ПРИНУДИТЕЛЬНЫЙ ЗОЛОТОЙ ЦВЕТ #FFD500
async function loadData() {
  const el = document.getElementById('totalStaked');
  const elTvl = document.getElementById('tvlUsd');
  
  try {
    const proxyUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent('https://moristake.in/api/v2/pool/total-staked');
    const resp = await fetch(proxyUrl);
    const proxyData = await resp.json();
    const data = JSON.parse(proxyData.contents);
   
    if (data.success && data.data.mori > 0) {
      const amount = Number(data.data.mori).toLocaleString('ru-RU');
      el.innerHTML = `<strong>${amount}</strong> $MORI`;
      el.style.color = '#FFD500';        // ← ПРИНУДИТЕЛЬНО золотой
      el.style.fontWeight = 'bold';
    } else {
      throw new Error('Нет данных');
    }

    if (data.data.usd > 0) {
      const tvl = Number(data.data.usd).toLocaleString('ru-RU');
      elTvl.innerHTML = `<strong>$${tvl}</strong>`;
      elTvl.style.color = '#FFD500';     // ← ПРИНУДИТЕЛЬНО золотой
      elTvl.style.fontWeight = 'bold';
    } else {
      elTvl.textContent = 'Нет данных';
      elTvl.style.color = '#ff6b6b';
    }
  } catch (err) {
    console.error('Ошибка:', err);
    el.textContent = 'Не удалось загрузить';
    el.style.color = '#ff6b6b';
    
    if (elTvl) {
      elTvl.textContent = 'Не удалось загрузить';
      elTvl.style.color = '#ff6b6b';
    }
  }
}

loadData();
setInterval(loadData, 10000);




</script>


</body>
</html>
